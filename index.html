<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>สมัครสมาชิก Bungkii</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Kanit&display=swap');

    /* Reset และ base */
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Kanit', sans-serif;
      background-color: #f8f8f9;
      margin: 0;
      padding: 16px;
      color: #071952;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }

    /* Container */
    .container {
      background: white;
      max-width: 900px;
      width: 100%;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgb(0 0 0 / 0.05);
      overflow: hidden;
      display: flex;
      flex-direction: row;
      gap: 0;
    }

    /* ซ้าย-ขวา */
    .left, .right {
      padding: 32px;
      flex: 1;
    }
    .left {
      border-right: 1px solid #ddd;
    }

    /* ข้อความหัวเรื่อง */
    h2 {
      margin-top: 0;
      font-weight: 600;
      font-size: 22px;
    }

    /* Label และ Input */
    label {
      display: block;
      margin-bottom: 6px;
      font-size: 16px;
      margin-top: 16px;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    /* แพ็กเกจเลือก */
    .package {
      margin-top: 12px;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .package input {
      margin: 0;
      cursor: pointer;
    }

    /* ปุ่มชำระเงิน */
    button {
      margin-top: 32px;
      width: 100%;
      background-color: #071952;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 18px;
      font-weight: 600;
      padding: 14px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:disabled {
      background-color: #555a7e;
      cursor: not-allowed;
    }
    button:hover:not(:disabled) {
      background-color: #0a1a4a;
    }

    /* QR section */
    .qr-section {
      margin-top: 24px;
      text-align: center;
    }
    .qr-section img {
      width: 200px;
      height: 200px;
      object-fit: contain;
      border-radius: 8px;
      border: 1px solid #e0e0e0;
      background-color: white;
    }
    .qr-section p {
      margin-top: 12px;
      font-size: 16px;
    }

    /* Success Code */
    .success-code {
      margin-top: 32px;
      border-top: 1px solid #ddd;
      padding-top: 20px;
      text-align: center;
      color: #0a7c3c;
      font-weight: 600;
      font-size: 20px;
    }
    .success-code p.code {
      font-size: 24px;
      font-weight: bold;
      letter-spacing: 1.2;
      margin: 8px 0 0;
    }

    /* วิธีชำระเงิน */
    .payment-method {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      font-size: 16px;
      color: #071952;
      gap: 8px;
    }
    .payment-method svg {
      fill: #071952;
      width: 24px;
      height: 24px;
    }

    /* Responsive: บนจอเล็ก ให้ซ้าย-ขวาเป็นแนวตั้ง */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      .container {
        flex-direction: column;
        border-radius: 8px;
      }
      .left {
        border-right: none;
        border-bottom: 1px solid #ddd;
        padding: 20px;
      }
      .right {
        padding: 20px;
      }
      .qr-section img {
        width: 180px;
        height: 180px;
      }
      button {
        font-size: 16px;
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="left">
      <h2>สมัครพรีเมี่ยม ให้บุงกี</h2>
      <label for="phoneEmail">ชื่อไอจี</label>
      <input id="phoneEmail" type="text" placeholder="ชื่ออะไรก็บอกมาเร้วๆ" />

      <label>เลือกแพ็กเกจ</label>
      <label class="package">
        <input type="radio" name="package" value="99" />
        1 สัปดาห์ – 99 บาท
      </label>
      <label class="package">
        <input type="radio" name="package" value="299" />
        1 เดือน – 299 บาท
      </label>
      <label class="package">
        <input type="radio" name="package" value="1190" />
        1 ปี – 1190 บาท
      </label>

      <div class="qr-section" id="qrSection" style="display:none;">
        <h2>สแกน QR พร้อมเพย์</h2>
        <img id="qrImage" src="" alt="QR PromptPay" />
        <p>ยอดที่ต้องชำระ: <strong id="amountText"></strong> บาท</p>
      </div>
    </div>
    <div class="right">
      <h2>วิธีชำระเงิน</h2>
      <div class="payment-method">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5,4 L19,4 C20.1,4 21,4.9 21,6 L21,18 C21,19.1 20.1,20 19,20 L5,20 C3.9,20 3,19.1 3,18 L3,6 C3,4.9 3.9,4 5,4 Z M12,16 L17,16 L17,14 L12,14 L12,16 Z M7,16 L10,16 L10,14 L7,14 L7,16 Z M12,12 L17,12 L17,10 L12,10 L12,12 Z M7,12 L10,12 L10,10 L7,10 L7,12 Z" /></svg>
        QR Promptpay
      </div>

      <button id="payBtn">ชำระเงิน</button>

      <div class="success-code" id="successCode" style="display:none;">
        <p>ชำระเงินแล้ว</p>
        <p>ขอบคุณที่สนับสนุนบุงกี</p>
        <p>รหัสลับของมึงคือ</p>
        <p class="code" id="redeemCodeText"></p>
      </div>
    </div>
  </div>

  <script>
    const promptpayNumber = "0925384159";
    const payBtn = document.getElementById("payBtn");
    const phoneEmailInput = document.getElementById("phoneEmail");
    const qrSection = document.getElementById("qrSection");
    const qrImage = document.getElementById("qrImage");
    const amountText = document.getElementById("amountText");
    const successCode = document.getElementById("successCode");
    const redeemCodeText = document.getElementById("redeemCodeText");

    let selectedPackage = null;

    // แพ็คเกจเปลี่ยน
    document.querySelectorAll('input[name="package"]').forEach(radio => {
      radio.addEventListener("change", () => {
        selectedPackage = radio.value;
        qrSection.style.display = "block";
        // ใช้ promptpay.io สร้าง QR พร้อมเพย์แบบ dynamic
        qrImage.src = `https://promptpay.io/${promptpayNumber}/${selectedPackage}.png`;
        amountText.textContent = selectedPackage;
        successCode.style.display = "none";
      });
    });

    function generateRedeemCode() {
      const part1 = Math.random().toString(36).substring(2, 6).toUpperCase();
      const part2 = Math.random().toString(36).substring(2, 6).toUpperCase();
      return `${part1}-${part2}`;
    }

    payBtn.addEventListener("click", () => {
      const phoneEmail = phoneEmailInput.value.trim();
      if (!phoneEmail) {
        alert("กรุณากรอกชื่อไอจี");
        return;
      }
      if (!selectedPackage) {
        alert("กรุณาเลือกแพ็กเกจ");
        return;
      }

      payBtn.disabled = true;
      payBtn.textContent = "ตรวจสอบการชำระ...";

      qrSection.style.display = "block";

      // จำลองรอ 7 วิ แล้วขึ้นว่า จ่ายสำเร็จ (คุณเปลี่ยนให้ตรวจสอบยอดจริงได้)
      setTimeout(() => {
        const redeemCode = generateRedeemCode();
        redeemCodeText.textContent = redeemCode;
        successCode.style.display = "block";
        payBtn.disabled = false;
        payBtn.textContent = "ชำระเงิน";

        // ส่งข้อมูลไป Google Apps Script
        fetch("https://script.google.com/macros/s/AKfycbzZz43qePZLX1CsmDwsuiYGh49kdDuV_HD3-5IEkjk4p2OVcDaXzMryZFnxO83AHRJI/exec", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            phoneOrEmail: phoneEmail,
            packageName: `${selectedPackage} บาท`,
            amount: Number(selectedPackage),
            redeemCode: redeemCode,
            status: "success"
          })
        }).catch(err => {
          console.error("ส่งข้อมูลล้มเหลว", err);
        });
      }, 7000);
    });
  </script>
</body>
</html>
